# -*- coding: utf-8 -*-
"""Untitled2.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1gvtnAbMRkRSrBV0idCjjmvddhZDmKECT
"""

from google.colab import files
uploaded = files.upload()

!pip install streamlit tensorflow pillow numpy --quiet

import streamlit as st
import tensorflow as tf
import numpy as np
from PIL import Image

model = tf.keras.models.load_model('/content/plant_disease_multiclass_model.h5', compile=False)

class_labels = [
    'Apple___Apple_scab', 'Apple___Black_rot', 'Apple___Cedar_apple_rust',
    'Cherry_(including_sour)___Powdery_mildew', 'Corn_(maize)___Cercospora_leaf_spot Gray_leaf_spot',
    'Corn_(maize)___Common_rust_', 'Corn_(maize)___Northern_Leaf_Blight',
    'Grape___Black_rot', 'Grape___Esca_(Black_Measles)', 'Grape___Leaf_blight_(Isariopsis_Leaf_Spot)',
    'Orange___Haunglongbing_(Citrus_greening)', 'Peach___Bacterial_spot', 'Pepper__bell___Bacterial_spot',
    'Potato___Early_blight', 'Potato___Late_blight', 'Squash___Powdery_mildew',
    'Strawberry___Leaf_scorch', 'Tomato_Bacterial_spot', 'Tomato_Early_blight',
    'Tomato_Late_blight', 'Tomato_Leaf_Mold', 'Tomato_Septoria_leaf_spot',
    'Tomato_Spider_mites_Two_spotted_spider_mite', 'Tomato__Target_Spot',
    'Tomato__Tomato_YellowLeaf__Curl_Virus', 'Tomato__Tomato_mosaic_virus', 'healthy'
]

malayalam_labels = [
    'เดเดชเตเดชเดฟเตพ___เดเดชเตเดชเดฟเตพ เดธเตเดเดพเดฌเต', 'เดเดชเตเดชเดฟเตพ___เดฌเตเดฒเดพเดเตเดเต เดฑเตเดเตเดเต', 'เดเดชเตเดชเดฟเตพ___เดธเดฟเดกเดพเตผ เดเดชเตเดชเดฟเตพ เดเดเดเต',
    'เดเตเดฑเดฟ___เดชเตเดกเดฑเดฟ เดฎเดฟเตฝเดกเตเดฏเต', 'เดฎเดเดพเตบ___เดธเตผเดเตเดเตเดธเตเดชเตเดฑ เดฒเตเดซเต เดธเตเดชเตเดเตเดเต/เดเตเดฐเต เดฒเตเดซเต เดธเตเดชเตเดเตเดเต',
    'เดฎเดเดพเตบ___เดธเดพเดงเดพเดฐเดฃ เดเดเดเต', 'เดฎเดเดพเตบ___เดจเตเตผเดคเตเดคเต เดฒเตเดซเต เดฌเตเดฒเตเดฑเตเดฑเต',
    'เดฆเตเดฐเดพเดเตเดทเดฟ___เดฌเตเดฒเดพเดเตเดเต เดฑเตเดเตเดเต', 'เดฆเตเดฐเดพเดเตเดทเดฟ___เดเดธเตเด (เดฌเตเดฒเดพเดเตเดเต เดฎเตเดธเตฝ)', 'เดฆเตเดฐเดพเดเตเดทเดฟ___เดฒเตเดซเต เดฌเตเดฒเตเดฑเตเดฑเต',
    'เดเดฑเดเตเดเต___เดนเตเดเตโเดฒเตเดเตเดเตเดฌเดฟเดเตเดเต', 'เดชเตเดเตเดเต___เดฌเดพเดเตเดเตเดฐเดฟเดฏเตฝ เดธเตเดชเตเดเตเดเต', 'เดเตเดฏเดพเดชเตเดธเดฟเดเตเดเด___เดฌเดพเดเตเดเตเดฐเดฟเดฏเตฝ เดธเตเดชเตเดเตเดเต',
    'เดเดฐเตเดณเดเตเดเดฟเดดเดเตเดเต___เดเดฆเตเดฏ เดฌเตเดฒเตเดฑเตเดฑเต', 'เดเดฐเตเดณเดเตเดเดฟเดดเดเตเดเต___เดฒเตเดฑเตเดฑเต เดฌเตเดฒเตเดฑเตเดฑเต', 'เดธเตเดเตเดตเดพเดทเต___เดชเตเดกเดฑเดฟ เดฎเดฟเตฝเดกเตเดฏเต',
    'เดธเตเดเตเดฐเตเดพเดฌเตเดฑเดฟ___เดฒเตเดซเต เดธเตเดเตเตผเดเตเดเต', 'เดคเดเตเดเดพเดณเดฟ___เดฌเดพเดเตเดเตเดฐเดฟเดฏเตฝ เดธเตเดชเตเดเตเดเต', 'เดคเดเตเดเดพเดณเดฟ___เดเดฆเตเดฏ เดฌเตเดฒเตเดฑเตเดฑเต',
    'เดคเดเตเดเดพเดณเดฟ___เดฒเตเดฑเตเดฑเต เดฌเตเดฒเตเดฑเตเดฑเต', 'เดคเดเตเดเดพเดณเดฟ___เดฒเตเดซเต เดฎเตเตพเดกเต', 'เดคเดเตเดเดพเดณเดฟ___เดธเตเดชเตเดเตเดฑเดฟเดฏ เดฒเตเดซเต เดธเตเดชเตเดเตเดเต',
    'เดคเดเตเดเดพเดณเดฟ___เดธเตเดชเตเดกเตผ เดฎเตเดฑเตเดฑเตเดธเต', 'เดคเดเตเดเดพเดณเดฟ___เดเดพเตผเดเดฑเตเดฑเต เดธเตเดชเตเดเตเดเต',
    'เดคเดเตเดเดพเดณเดฟ___เดชเดเตเดเดฎเดเตเด เดเดฑเตเดชเตเดชเต เดตเตเดฑเดธเต', 'เดคเดเตเดเดพเดณเดฟ___เดฎเตเดธเตเดเต เดตเตเดฑเดธเต', 'เดเดฐเตเดเตเดฏเดฎเตเดณเตเดณ'
]

spanish_labels = [
    'Manzana___Costra del manzano', 'Manzana___Podredumbre negra', 'Manzana___Royas del manzano',
    'Cereza___Mildiu polvoriento', 'Maรญz___Mancha foliar gris',
    'Maรญz___Royas comunes', 'Maรญz___Tizรณn de la hoja del norte',
    'Uva___Podredumbre negra', 'Uva___Esca (Measles negras)', 'Uva___Tizรณn de la hoja',
    'Naranja___Huanglongbing (Greening)', 'Melocotรณn___Mancha bacteriana', 'Pimiento___Mancha bacteriana',
    'Papa___Tizรณn temprano', 'Papa___Tizรณn tardรญo', 'Calabaza___Mildiu polvoriento',
    'Fresa___Escaldadura de la hoja', 'Tomate___Mancha bacteriana', 'Tomate___Tizรณn temprano',
    'Tomate___Tizรณn tardรญo', 'Tomate___Moho de la hoja', 'Tomate___Mancha foliar Septoria',
    'Tomate___รcaros de dos puntos', 'Tomate___Mancha objetivo',
    'Tomate___Virus del rizado amarillo', 'Tomate___Virus del mosaico', 'Saludable'
]

st.set_page_config(page_title="๐ฟ Plant Disease Detector (Multilingual)", layout="centered")
st.title("๐ฟ Plant Disease Detection App (Multilingual)")
st.write("Upload multiple leaf images ๐ท and detect diseases in English, Malayalam, or Spanish! ๐")

language = st.selectbox("๐ Choose Language:", ["English", "Malayalam", "Spanish"])

uploaded_files = st.file_uploader("๐ท Upload Multiple Leaf Images", accept_multiple_files=True, type=["jpg", "jpeg", "png"])

if st.button("๐ Predict Diseases"):
    if uploaded_files:
        for uploaded_file in uploaded_files:
            img = Image.open(uploaded_file).convert('RGB')
            img_resized = img.resize((128, 128))
            img_array = np.expand_dims(np.array(img_resized) / 255.0, axis=0)

            prediction = model.predict(img_array)
            predicted_class_index = np.argmax(prediction)

            if language == "English":
                label = class_labels[predicted_class_index]
            elif language == "Malayalam":
                label = malayalam_labels[predicted_class_index]
            elif language == "Spanish":
                label = spanish_labels[predicted_class_index]
            else:
                label = class_labels[predicted_class_index]

            confidence = np.max(prediction) * 100

            st.image(img, caption=f"๐ฟ Prediction: {label} (Confidence: {confidence:.2f}%)", width=300)
            st.markdown(f"### ๐ฑ {label}")
            st.markdown(f"๐ต Confidence: {confidence:.2f}%")
            st.markdown("---")
    else:
        st.warning("โ๏ธ Please upload at least one leaf image first.")

